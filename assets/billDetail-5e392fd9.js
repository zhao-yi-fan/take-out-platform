import{d as w,v as L,b as D,e as b,n as T,r as n,o as p,c as f,h as t,a,t as q,F as B,k as C,j as N,x as d,y as U,z as A,A as F,p as O,l as R,_ as j}from"./index-60e0fd6e.js";import{u as z}from"./shopStore-0463a4aa.js";import{u as E}from"./orderStore-20f5f1ee.js";const v=l=>(O("data-v-429384b9"),l=l(),R(),l),G={class:"top-bill"},M={class:"top-bill-return"},H=v(()=>t("div",{class:"top-bill-title"},"外卖配送",-1)),J={class:"top-bill-address"},K=v(()=>t("p",null,[t("span",null,"立即送出"),t("span",{class:"r"},"大概15分钟后抵达")],-1)),P={class:"top-bill-shopList"},Q=w({__name:"billDetail",setup(l){const h=z(),c=E(),y=L(),m=D(),_=b(h.baseAddress.name),u=b({foodList:[],money:0}),e=T({address:"",people:"",phone:"",businessesId:y.query.businessesId}),I=async()=>{if(e.address)if(e.people){if(!e.phone)return d("请填写联系方式")}else return d("请填写收货人");else return d("请填写收货地址");let r=await c.setOrderStatus({address:_+"--"+e.address,businessesId:e.businessesId,people:e.people,phone:e.phone});U({message:"正在支付请稍候...",forbidClick:!0}),setTimeout(()=>{A(),r?(F("支付成功"),m.push("/home/index")):d("支付失败")},2e3)},S=()=>{m.go(-1)};return(()=>{const r=c.orderList.find(o=>o.businessesId==e.businessesId&&o.status=="apply");u.value=r})(),(r,o)=>{const V=n("van-icon"),g=n("van-notice-bar"),i=n("van-field"),x=n("van-card"),k=n("van-submit-bar");return p(),f("div",G,[t("div",M,[a(V,{name:"arrow-left",onClick:S})]),a(g,{scrollable:"",text:"为减少接触，降低风险，请注意与外卖人员的安全距离。"}),H,t("div",J,[t("p",null,q(_.value),1),a(i,{modelValue:e.address,"onUpdate:modelValue":o[0]||(o[0]=s=>e.address=s),name:"address",label:"详细地址",placeholder:"详细地址",rules:[{required:!0,message:"请填写详细地址"}]},null,8,["modelValue"]),a(i,{modelValue:e.people,"onUpdate:modelValue":o[1]||(o[1]=s=>e.people=s),label:"收货人",name:"people",placeholder:"收货人",rules:[{required:!0,message:"请填写收货人"}]},null,8,["modelValue"]),a(i,{modelValue:e.phone,"onUpdate:modelValue":o[2]||(o[2]=s=>e.phone=s),name:"phone",type:"tel",label:"联系方式",placeholder:"联系方式",rules:[{required:!0,message:"请填写联系方式"}]},null,8,["modelValue"]),K]),t("div",P,[(p(!0),f(B,null,C(u.value.foodList,s=>(p(),N(x,{num:s.foodNum,price:s.foodMoney,desc:s.commodityDescribe,title:s.foodName,thumb:s.foodImageUrl,key:s.foodId},null,8,["num","price","desc","title","thumb"]))),128))]),a(k,{price:u.value.money*100,"button-text":"确认支付",onSubmit:I},null,8,["price"])])}}});const $=j(Q,[["__scopeId","data-v-429384b9"]]);export{$ as default};
