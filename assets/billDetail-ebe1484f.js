import{u as v}from"./shopStore-5e5560f7.js";import{u as f}from"./orderStore-31f301f2.js";import{_ as h}from"./index-84aac008.js";import"./vendor-7ce8fbae.js";const N={class:"top-bill"},y={class:"top-bill-return"},g={class:"top-bill-address"},E={class:"top-bill-shopList"},I=Vue.defineComponent({__name:"billDetail",setup(k){const d=v(),r=f(),i=VueRouter.useRoute(),a=VueRouter.useRouter(),u=Vue.ref(d.baseAddress.name),n=Vue.ref({foodList:[],money:0}),e=Vue.reactive({address:"",people:"",phone:"",businessesId:i.query.businessesId}),p=async()=>{if(e.address)if(e.people){if(!e.phone)return vant.showFailToast("请填写联系方式")}else return vant.showFailToast("请填写收货人");else return vant.showFailToast("请填写收货地址");let s=await r.setOrderStatus({address:u+"--"+e.address,businessesId:e.businessesId,people:e.people,phone:e.phone});vant.showLoadingToast({message:"正在支付请稍候...",forbidClick:!0}),setTimeout(()=>{vant.closeToast(),s?(vant.showSuccessToast("支付成功"),a.push("/home/index")):vant.showFailToast("支付失败")},2e3)},c=()=>{a.go(-1)};return(()=>{const s=r.orderList.find(o=>o.businessesId==e.businessesId&&o.status=="apply");n.value=s})(),(s,o)=>{const m=Vue.resolveComponent("van-icon"),V=Vue.resolveComponent("van-notice-bar"),l=Vue.resolveComponent("van-field"),_=Vue.resolveComponent("van-card"),b=Vue.resolveComponent("van-submit-bar");return Vue.openBlock(),Vue.createElementBlock("div",N,[Vue.createElementVNode("div",y,[Vue.createVNode(m,{name:"arrow-left",onClick:c})]),Vue.createVNode(V,{scrollable:"",text:"为减少接触，降低风险，请注意与外卖人员的安全距离。"}),o[4]||(o[4]=Vue.createElementVNode("div",{class:"top-bill-title"},"外卖配送",-1)),Vue.createElementVNode("div",g,[Vue.createElementVNode("p",null,Vue.toDisplayString(u.value),1),Vue.createVNode(l,{modelValue:e.address,"onUpdate:modelValue":o[0]||(o[0]=t=>e.address=t),name:"address",label:"详细地址",placeholder:"详细地址",rules:[{required:!0,message:"请填写详细地址"}]},null,8,["modelValue"]),Vue.createVNode(l,{modelValue:e.people,"onUpdate:modelValue":o[1]||(o[1]=t=>e.people=t),label:"收货人",name:"people",placeholder:"收货人",rules:[{required:!0,message:"请填写收货人"}]},null,8,["modelValue"]),Vue.createVNode(l,{modelValue:e.phone,"onUpdate:modelValue":o[2]||(o[2]=t=>e.phone=t),name:"phone",type:"tel",label:"联系方式",placeholder:"联系方式",rules:[{required:!0,message:"请填写联系方式"}]},null,8,["modelValue"]),o[3]||(o[3]=Vue.createElementVNode("p",{class:"flex items-center justify-between"},[Vue.createElementVNode("span",null,"立即送出"),Vue.createElementVNode("span",null,"大概15分钟后抵达")],-1))]),Vue.createElementVNode("div",E,[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(n.value.foodList,t=>(Vue.openBlock(),Vue.createBlock(_,{num:t.foodNum,price:t.foodMoney,desc:t.commodityDescribe,title:t.foodName,thumb:t.foodImageUrl,key:t.foodId},null,8,["num","price","desc","title","thumb"]))),128))]),Vue.createVNode(b,{price:n.value.money*100,"button-text":"确认支付",onSubmit:p},null,8,["price"])])}}});const B=h(I,[["__scopeId","data-v-7fa73b10"]]);export{B as default};
