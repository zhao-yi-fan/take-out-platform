import{showFailToast as r,showLoadingToast as x,closeToast as k,showSuccessToast as w}from"vant";import{useRoute as L,useRouter as D}from"vue-router";import{u as T}from"./shopStore-14156849.js";import{u as q}from"./orderStore-69f1a9a9.js";import{d as B,b as _,l as C,r as l,o as u,c as b,g as t,a as n,t as N,F as U,j as F,i as O,_ as j}from"./index-7a5bb6f9.js";const A={class:"top-bill"},R={class:"top-bill-return"},E={class:"top-bill-address"},G={class:"top-bill-shopList"},M=B({__name:"billDetail",setup(z){const f=T(),p=q(),v=L(),c=D(),m=_(f.baseAddress.name),d=_({foodList:[],money:0}),e=C({address:"",people:"",phone:"",businessesId:v.query.businessesId}),h=async()=>{if(e.address)if(e.people){if(!e.phone)return r("请填写联系方式")}else return r("请填写收货人");else return r("请填写收货地址");let a=await p.setOrderStatus({address:m+"--"+e.address,businessesId:e.businessesId,people:e.people,phone:e.phone});x({message:"正在支付请稍候...",forbidClick:!0}),setTimeout(()=>{k(),a?(w("支付成功"),c.push("/home/index")):r("支付失败")},2e3)},y=()=>{c.go(-1)};return(()=>{const a=p.orderList.find(s=>s.businessesId==e.businessesId&&s.status=="apply");d.value=a})(),(a,s)=>{const g=l("van-icon"),V=l("van-notice-bar"),i=l("van-field"),I=l("van-card"),S=l("van-submit-bar");return u(),b("div",A,[t("div",R,[n(g,{name:"arrow-left",onClick:y})]),n(V,{scrollable:"",text:"为减少接触，降低风险，请注意与外卖人员的安全距离。"}),s[4]||(s[4]=t("div",{class:"top-bill-title"},"外卖配送",-1)),t("div",E,[t("p",null,N(m.value),1),n(i,{modelValue:e.address,"onUpdate:modelValue":s[0]||(s[0]=o=>e.address=o),name:"address",label:"详细地址",placeholder:"详细地址",rules:[{required:!0,message:"请填写详细地址"}]},null,8,["modelValue"]),n(i,{modelValue:e.people,"onUpdate:modelValue":s[1]||(s[1]=o=>e.people=o),label:"收货人",name:"people",placeholder:"收货人",rules:[{required:!0,message:"请填写收货人"}]},null,8,["modelValue"]),n(i,{modelValue:e.phone,"onUpdate:modelValue":s[2]||(s[2]=o=>e.phone=o),name:"phone",type:"tel",label:"联系方式",placeholder:"联系方式",rules:[{required:!0,message:"请填写联系方式"}]},null,8,["modelValue"]),s[3]||(s[3]=t("p",{class:"flex items-center justify-between"},[t("span",null,"立即送出"),t("span",null,"大概15分钟后抵达")],-1))]),t("div",G,[(u(!0),b(U,null,F(d.value.foodList,o=>(u(),O(I,{num:o.foodNum,price:o.foodMoney,desc:o.commodityDescribe,title:o.foodName,thumb:o.foodImageUrl,key:o.foodId},null,8,["num","price","desc","title","thumb"]))),128))]),n(S,{price:d.value.money*100,"button-text":"确认支付",onSubmit:h},null,8,["price"])])}}});const X=j(M,[["__scopeId","data-v-7fa73b10"]]);export{X as default};
