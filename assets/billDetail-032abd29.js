import{d as S,p as k,b as w,e as _,m as L,r as l,o as i,c as b,h as t,a as n,t as q,F as D,k as T,j as B,q as r,v as C,x as N,y as U,_ as F}from"./index-2b792c60.js";import{u as O}from"./shopStore-d4a4b827.js";import{u as j}from"./orderStore-0bfb5c9c.js";const A={class:"top-bill"},R={class:"top-bill-return"},E={class:"top-bill-address"},G={class:"top-bill-shopList"},M=S({__name:"billDetail",setup(z){const f=O(),p=j(),v=k(),c=w(),m=_(f.baseAddress.name),d=_({foodList:[],money:0}),e=L({address:"",people:"",phone:"",businessesId:v.query.businessesId}),h=async()=>{if(e.address)if(e.people){if(!e.phone)return r("请填写联系方式")}else return r("请填写收货人");else return r("请填写收货地址");let a=await p.setOrderStatus({address:m+"--"+e.address,businessesId:e.businessesId,people:e.people,phone:e.phone});C({message:"正在支付请稍候...",forbidClick:!0}),setTimeout(()=>{N(),a?(U("支付成功"),c.push("/home/index")):r("支付失败")},2e3)},y=()=>{c.go(-1)};return(()=>{const a=p.orderList.find(s=>s.businessesId==e.businessesId&&s.status=="apply");d.value=a})(),(a,s)=>{const V=l("van-icon"),g=l("van-notice-bar"),u=l("van-field"),I=l("van-card"),x=l("van-submit-bar");return i(),b("div",A,[t("div",R,[n(V,{name:"arrow-left",onClick:y})]),n(g,{scrollable:"",text:"为减少接触，降低风险，请注意与外卖人员的安全距离。"}),s[4]||(s[4]=t("div",{class:"top-bill-title"},"外卖配送",-1)),t("div",E,[t("p",null,q(m.value),1),n(u,{modelValue:e.address,"onUpdate:modelValue":s[0]||(s[0]=o=>e.address=o),name:"address",label:"详细地址",placeholder:"详细地址",rules:[{required:!0,message:"请填写详细地址"}]},null,8,["modelValue"]),n(u,{modelValue:e.people,"onUpdate:modelValue":s[1]||(s[1]=o=>e.people=o),label:"收货人",name:"people",placeholder:"收货人",rules:[{required:!0,message:"请填写收货人"}]},null,8,["modelValue"]),n(u,{modelValue:e.phone,"onUpdate:modelValue":s[2]||(s[2]=o=>e.phone=o),name:"phone",type:"tel",label:"联系方式",placeholder:"联系方式",rules:[{required:!0,message:"请填写联系方式"}]},null,8,["modelValue"]),s[3]||(s[3]=t("p",{class:"flex items-center justify-between"},[t("span",null,"立即送出"),t("span",null,"大概15分钟后抵达")],-1))]),t("div",G,[(i(!0),b(D,null,T(d.value.foodList,o=>(i(),B(I,{num:o.foodNum,price:o.foodMoney,desc:o.commodityDescribe,title:o.foodName,thumb:o.foodImageUrl,key:o.foodId},null,8,["num","price","desc","title","thumb"]))),128))]),n(x,{price:d.value.money*100,"button-text":"确认支付",onSubmit:h},null,8,["price"])])}}});const Q=F(M,[["__scopeId","data-v-7fa73b10"]]);export{Q as default};
