import{defineComponent as x,ref as _,reactive as k,resolveComponent as l,openBlock as u,createElementBlock as b,createElementVNode as t,createVNode as n,toDisplayString as w,Fragment as L,renderList as D,createBlock as T}from"vue";import{showFailToast as a,showLoadingToast as q,closeToast as C,showSuccessToast as N}from"vant";import{useRoute as U,useRouter as B}from"vue-router";import{u as O}from"./shopStore-4648f8f7.js";import{u as A}from"./orderStore-6d3915d0.js";import{_ as E}from"./index-75cbb4ee.js";import"./vendor-aa74e335.js";const F={class:"top-bill"},R={class:"top-bill-return"},j={class:"top-bill-address"},G={class:"top-bill-shopList"},M=x({__name:"billDetail",setup(z){const f=O(),p=A(),v=U(),c=B(),m=_(f.baseAddress.name),d=_({foodList:[],money:0}),e=k({address:"",people:"",phone:"",businessesId:v.query.businessesId}),h=async()=>{if(e.address)if(e.people){if(!e.phone)return a("请填写联系方式")}else return a("请填写收货人");else return a("请填写收货地址");let r=await p.setOrderStatus({address:m+"--"+e.address,businessesId:e.businessesId,people:e.people,phone:e.phone});q({message:"正在支付请稍候...",forbidClick:!0}),setTimeout(()=>{C(),r?(N("支付成功"),c.push("/home/index")):a("支付失败")},2e3)},y=()=>{c.go(-1)};return(()=>{const r=p.orderList.find(o=>o.businessesId==e.businessesId&&o.status=="apply");d.value=r})(),(r,o)=>{const V=l("van-icon"),g=l("van-notice-bar"),i=l("van-field"),I=l("van-card"),S=l("van-submit-bar");return u(),b("div",F,[t("div",R,[n(V,{name:"arrow-left",onClick:y})]),n(g,{scrollable:"",text:"为减少接触，降低风险，请注意与外卖人员的安全距离。"}),o[4]||(o[4]=t("div",{class:"top-bill-title"},"外卖配送",-1)),t("div",j,[t("p",null,w(m.value),1),n(i,{modelValue:e.address,"onUpdate:modelValue":o[0]||(o[0]=s=>e.address=s),name:"address",label:"详细地址",placeholder:"详细地址",rules:[{required:!0,message:"请填写详细地址"}]},null,8,["modelValue"]),n(i,{modelValue:e.people,"onUpdate:modelValue":o[1]||(o[1]=s=>e.people=s),label:"收货人",name:"people",placeholder:"收货人",rules:[{required:!0,message:"请填写收货人"}]},null,8,["modelValue"]),n(i,{modelValue:e.phone,"onUpdate:modelValue":o[2]||(o[2]=s=>e.phone=s),name:"phone",type:"tel",label:"联系方式",placeholder:"联系方式",rules:[{required:!0,message:"请填写联系方式"}]},null,8,["modelValue"]),o[3]||(o[3]=t("p",{class:"flex items-center justify-between"},[t("span",null,"立即送出"),t("span",null,"大概15分钟后抵达")],-1))]),t("div",G,[(u(!0),b(L,null,D(d.value.foodList,s=>(u(),T(I,{num:s.foodNum,price:s.foodMoney,desc:s.commodityDescribe,title:s.foodName,thumb:s.foodImageUrl,key:s.foodId},null,8,["num","price","desc","title","thumb"]))),128))]),n(S,{price:d.value.money*100,"button-text":"确认支付",onSubmit:h},null,8,["price"])])}}});const Z=E(M,[["__scopeId","data-v-7fa73b10"]]);export{Z as default};
